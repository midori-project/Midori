{
  "name": "chat",
  "description": "AI Chat interface สำหรับรับ user input และแปลงเป็น Command",
  "model": "gpt-5-nano",
  "temperature": 0.3,
  "produces": [
    "Command",
    "CommandEvent",
    "Message"
  ],
  "consumes": [
    "UserInput",
    "Conversation"
  ],
  "schemas": {
    "command": "../schemas/command.schema.json",
    "conversation": "../schemas/conversation.schema.json",
    "message": "../schemas/message.schema.json"
  },
  "policies": {
    "qualityGates": "../policies/quality-gates.json",
    "escalation": "../policies/escalation.json",
    "interaction": "../policies/interaction.json"
  },
  "systemPrompt": "../../prompts/chat.system.md",
  "capabilities": [
    "natural_language_processing",
    "intent_recognition",
    "command_generation",
    "clarifying_questions",
    "context_understanding"
  ],
  "triggers": [
    "user_message",
    "follow_up_question",
    "command_clarification"
  ],
  "features": {
    "multiLanguage": ["th", "en"],
    "contextWindow": 8000,
    "clarifyingQuestions": true,
    "commandValidation": true,
    "languagePolicy": {
      "preferUserLanguage": true,
      "fallback": "en",
      "translation": "auto"
    },
    "intentDetection": {
      "threshold": 0.6,
      "intents": [
        "create_project",
        "modify_component",
        "write_copy",
        "request_image",
        "ask_question"
      ]
    },
    "slotFilling": {
      "requiredSlots": ["action", "target"],
      "optionalSlots": ["framework", "layout", "page", "component", "brand"],
      "mapping": {
        "action": "command.action",
        "target": "command.target",
        "framework": "command.preferences.framework",
        "layout": "command.preferences.layout",
        "page": "command.scope.page",
        "component": "command.scope.component",
        "brand": "command.context.brand"
      },
      "maxClarifyingTurns": 2
    },
    "clarificationPolicy": {
      "askWhen": {
        "intentConfidenceBelow": 0.6,
        "missingRequiredSlots": true,
        "ambiguousCommand": true
      },
      "style": "brief_then_specific",
      "maxTurns": 2
    },
    "memory": {
      "strategy": "rolling_summary",
      "maxTurns": 20,
      "summaryEveryTurns": 8
    },
    "safety": {
      "filters": ["pii", "toxicity", "malware"],
      "action": "refuse_or_safe_complete"
    },
    "handoffRules": {
      "toQuestion": {
        "when": [
          "intentConfidenceBelowThreshold",
          "missingRequiredSlots"
        ]
      },
      "toOrchestrator": {
        "when": ["commandConstructed"]
      }
    }
  }
}
