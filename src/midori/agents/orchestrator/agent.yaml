name: orchestrator
version: "1.0.0"
role: "Unified Chat AI & Multi-Agent Orchestrator"
description: "Unified agent that handles chat interactions with users AND orchestrates execution across frontend, backend, and devops agents"

# Input/Output Contracts (‡∏Ç‡∏¢‡∏≤‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°)
consumes: ["user-message.schema.json", "conversation.schema.json"]
produces: [
  "chat-response.schema.json",
  "plan.schema.json", 
  "orchestrator-event.schema.json",
  "clarifying-question.schema.json"
]

# Agent Capabilities (‡∏Ç‡∏¢‡∏≤‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏° Chat AI)
capabilities:
  # Chat AI Capabilities
  - natural_language_understanding  # ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏†‡∏≤‡∏©‡∏≤‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥ (‡πÑ‡∏ó‡∏¢/‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©)
  - conversation_management        # ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ö‡∏ó‡∏™‡∏ô‡∏ó‡∏ô‡∏≤‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á
  - context_retention             # ‡∏à‡∏≥ context ‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏ó‡∏ô‡∏≤
  - requirement_analysis          # ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏≤‡∏Å chat
  - clarifying_questions          # ‡∏ñ‡∏≤‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
  - user_intent_classification    # ‡∏à‡∏≥‡πÅ‡∏ô‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
  
  # Orchestrator Capabilities  
  - task_breakdown               # ‡πÅ‡∏ö‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏à‡∏≤‡∏Å user requirements
  - dependency_analysis          # ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå dependencies
  - agent_assignment            # ‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡πâ agents
  - resource_allocation         # ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ resources
  - execution_planning          # ‡∏™‡∏£‡πâ‡∏≤‡∏á execution plans
  - quality_gates              # ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏ä‡πâ quality policies
  - progress_monitoring        # ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° progress ‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡πâ user

# Model Configuration (Testing: gpt-5-nano with actual parameters)
model:
  provider: openai
  name: gpt-5-nano     # üß™ Testing gpt-5-nano access  
  temperature: 1       # gpt-5 models only support temperature = 1
  max_completion_tokens: 2000  # gpt-5 uses max_completion_tokens parameter
  timeout: 120      # Standard timeout for reliable responses
  fallback:
    name: gpt-4o-mini
    temperature: 0.3
    max_tokens: 4000
    timeout: 60
  retry_policy:
    max_retries: 2
    fallback_on_failure: true
    fallback_triggers: ["rate_limit", "timeout", "api_error"]

# Agent Coordination (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°)
coordinates:
  - frontend   # Frontend development agent
  - backend    # Backend development agent  
  - devops     # DevOps and infrastructure agent

# Tools Available (‡πÄ‡∏û‡∏¥‡πà‡∏° Chat tools)
tools:
  # Chat AI Tools
  - conversation_tracker    # ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° conversation history
  - requirement_extractor  # ‡πÅ‡∏¢‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏≤‡∏Å chat
  - clarification_engine   # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
  - response_formatter     # ‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö
  
  # Orchestrator Tools (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°)
  - github_issues         # Create and manage GitHub issues
  - pr_review            # Review pull requests  
  - agent_dispatcher     # Dispatch tasks to other agents
  - quality_checker      # Check quality gates and policies

# Conversation Policies (Multi-language)
conversation:
  languages: ["th", "en"]
  personality: "friendly_helpful_professional"
  response_style: "conversational_professional"
  max_clarifying_questions: 3
  context_window: 20  # ‡∏à‡∏≥ 20 messages ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
  language_detection: "auto_from_user_input"
  maintain_language_consistency: true
  
# User Interaction Modes (‡πÉ‡∏´‡∏°‡πà)
interaction_modes:
  - casual_chat          # ‡∏™‡∏ô‡∏ó‡∏ô‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
  - requirement_gathering # ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
  - execution_mode       # ‡πÇ‡∏´‡∏°‡∏î‡∏™‡∏±‡πà‡∏á‡∏á‡∏≤‡∏ô agents
  - progress_reporting   # ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤
  - troubleshooting     # ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤

# Constraints and Safety (‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á)
constraints:
  - "no secrets in output"
  - "validate all schemas before output"
  - "enforce quality gates before execution"
  - "maintain audit trail for all decisions"
  - "respect resource limits and quotas"
  - "maintain professional but friendly tone in Thai"
  - "ask clarifying questions when requirements unclear"
  - "provide progress updates to user during execution"

# Quality Configuration (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°)
quality:
  smoke_checks: true
  contract_validation: true
  schema_validation: true
  policy_enforcement: true

# Execution Policies (‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á)
policies:
  max_parallel_tasks: 5
  max_execution_time: 3600  # 1 hour
  retry_attempts: 3
  escalation_threshold: 2   # failures before escalation
  
  # Chat-specific policies
  max_conversation_length: 50  # messages
  clarification_timeout: 300   # 5 minutes
  auto_suggest_alternatives: true
  context_cleanup_interval: 3600  # 1 hour

# Response Templates (Multi-language with auto-detection)
response_templates:
  greeting:
    en: "Hello! I'm Midori AI, ready to help you build amazing websites. What would you like to create today? üöÄ"
    th: "‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏ú‡∏° Midori AI ‡∏ú‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì ‡∏ö‡∏≠‡∏Å‡∏ú‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏∞‡πÑ‡∏£‡∏Ñ‡∏£‡∏±‡∏ö üöÄ"
  clarification:
    en: "I'd like to ask a few more questions to better understand your requirements:"
    th: "‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏ñ‡∏≤‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏ô‡∏¥‡∏î‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ú‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô:"
  execution_start:
    en: "Got it! I'll start working on your request now. I'll keep you updated on the progress."
    th: "‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏ú‡∏°‡∏à‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Ç‡∏≠ ‡∏ú‡∏°‡∏à‡∏∞‡πÅ‡∏à‡πâ‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏´‡πâ‡∏ó‡∏£‡∏≤‡∏ö‡∏Ñ‡∏£‡∏±‡∏ö"
  execution_complete:
    en: "All done! üéâ Here's what I've created for you:"
    th: "‡πÄ‡∏™‡∏£‡πá‡∏à‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö! üéâ ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ:"
  error_recovery:
    en: "I encountered a small issue, but don't worry - I'll help fix it."
    th: "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏á‡∏ß‡∏• ‡∏ú‡∏°‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏´‡πâ"
  progress_update:
    en: "Progress update: {task_name} is {progress}% complete."
    th: "‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤: {task_name} ‡πÄ‡∏™‡∏£‡πá‡∏à‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß {progress}%"
  task_delegated:
    en: "I've assigned this task to the {agent_name} agent. Expected completion: {eta}"
    th: "‡∏ú‡∏°‡πÑ‡∏î‡πâ‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ {agent_name} agent ‡πÅ‡∏•‡πâ‡∏ß ‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏™‡∏£‡πá‡∏à‡πÉ‡∏ô: {eta}"

# Language Detection & Response Strategy
language_handling:
  detection_method: "auto"  # auto-detect from user input
  fallback_language: "en"   # default when detection fails
  consistency_mode: "conversation"  # maintain same language throughout conversation
  supported_languages: ["en", "th"]
  detection_patterns:
    th: ["‡∏Ñ‡∏£‡∏±‡∏ö", "‡∏Ñ‡πà‡∏∞", "‡πÄ‡∏õ‡πá‡∏ô", "‡πÉ‡∏ô", "‡∏Å‡∏±‡∏ö", "‡πÅ‡∏•‡∏∞", "‡∏´‡∏£‡∏∑‡∏≠", "‡πÑ‡∏°‡πà", "‡∏°‡∏µ", "‡πÄ‡∏õ‡πá‡∏ô"]
    en: ["the", "and", "or", "is", "are", "can", "will", "would", "should", "have"]

# Intent Classification (Multi-language)
intent_patterns:
  create_website:
    th: ["‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ß‡πá‡∏ö", "‡∏ó‡∏≥‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå", "‡πÄ‡∏ß‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà", "‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö"]
    en: ["create website", "build website", "new website", "make website"]
  modify_existing:
    th: ["‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç", "‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô", "‡∏õ‡∏£‡∏±‡∏ö", "‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï"]
    en: ["modify", "change", "update", "edit", "alter"]
  add_feature:
    th: ["‡πÄ‡∏û‡∏¥‡πà‡∏°", "‡πÉ‡∏™‡πà", "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå", "‡πÄ‡∏™‡∏£‡∏¥‡∏°"]
    en: ["add", "include", "insert", "implement", "feature"]
  fix_issue:
    th: ["‡πÅ‡∏Å‡πâ", "‡∏ã‡πà‡∏≠‡∏°", "‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç", "‡πÅ‡∏Å‡πâ‡∏ö‡∏±‡∏Ñ"]
    en: ["fix", "repair", "debug", "resolve", "solve"]
  deploy:
    th: ["deploy", "‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà", "‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏ß‡πá‡∏ö", "launch", "‡πÄ‡∏õ‡∏¥‡∏î‡∏ï‡∏±‡∏ß"]
    en: ["deploy", "launch", "publish", "release", "go live"]
  help:
    th: ["‡∏ä‡πà‡∏ß‡∏¢", "‡∏™‡∏≠‡∏ô", "‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢", "‡∏ö‡∏≠‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ"]
    en: ["help", "teach", "explain", "guide", "assist"]
